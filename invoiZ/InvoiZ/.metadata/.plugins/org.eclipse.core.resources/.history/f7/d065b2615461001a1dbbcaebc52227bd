package dataSource;

import java.sql.Connection;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.Arrays;
import java.util.List;
import java.util.Map;

import javax.swing.JOptionPane;

import utilities.DataUtilities;

public class DataDelete {

	public static void invoiceDelete(String DealerName, String InvoiceNo) {
		Connection connection = null;
		connection = DatabaseConnect.dbConnector();
		Statement stmt = null;

		try {
			stmt = connection.createStatement();
			Map<String, List<String>> invo = DataUtilities.getInvoiceDetails(DealerName, InvoiceNo);
			String query1 = "DELETE FROM  invoice WHERE `InvoiceNo`='" + InvoiceNo + "' AND `DealerName`='" + DealerName
					+ "'";
			stmt.executeUpdate(query1);
			////////////////////////////
			
			List<String> chequeNos = invo.get("ChequeNo");
			
			String delim = ",";
			String res = String. join(delim, chequeNos);
			System. out. println(res);
			//DataDelete.RemoveInvoiceFromCheques(chequeNos,DealerName,InvoiceNo);
			
			
			JOptionPane.showMessageDialog(null, "Invoice is deleted successfully");
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			JOptionPane.showMessageDialog(null, "Something went wrong while deleting Invoice!");
			e.printStackTrace();
		} finally {
			try {
				if (stmt != null) {
					stmt.close();
				}

				if (connection != null) {
					connection.close();
				}
				;

			} catch (Exception e) {
				e.printStackTrace();
			}
		}
	}

	public static void DealerDelete(String dealer) {
		Connection connection = null;
		connection = DatabaseConnect.dbConnector();
		Statement stmt = null;

		try {
			stmt = connection.createStatement();
			String query1 = "DELETE FROM  dealer WHERE `DealerName`='" + dealer + "'";
			stmt.executeUpdate(query1);
			JOptionPane.showMessageDialog(null, "Dealer is deleted successfully");
		} catch (SQLException e) {
			JOptionPane.showMessageDialog(null, "Something went wrong while deleting Dealer!");
			e.printStackTrace();
		} finally {
			try {
				if (stmt != null) {
					stmt.close();
				}

				if (connection != null) {
					connection.close();
				}
				;

			} catch (Exception e) {
				e.printStackTrace();
			}
		}

	}

	public static void ChequeDelete(String cheque) {
		Connection connection = null;
		connection = DatabaseConnect.dbConnector();
		Statement stmt = null;

		try {
			stmt = connection.createStatement();
			String query1 = "DELETE FROM  cheque WHERE `ChequeNo`='" + cheque + "'";
			stmt.executeUpdate(query1);
			JOptionPane.showMessageDialog(null, "Cheque is deleted successfully");
		} catch (SQLException e) {
			JOptionPane.showMessageDialog(null, "Something went wrong while deleting Cheque!");
			e.printStackTrace();
		} finally {
			try {
				if (stmt != null) {
					stmt.close();
				}

				if (connection != null) {
					connection.close();
				}
				;

			} catch (Exception e) {
				e.printStackTrace();
			}
		}
	}

	public static void RemoveInvoiceFromCheques(String[] chequeNos) { // when we delete invoice we should remove it from chequesit was added .
		Connection connection = null;
		connection = DatabaseConnect.dbConnector();
		Statement stmt = null;
		java.util.List<String> list = Arrays.asList(chequeNos);
		try {
			stmt = connection.createStatement();
			for (String string : list) {
				
			}
			stmt = connection.createStatement();

		} catch (SQLException e) {
			JOptionPane.showMessageDialog(null, "Something went wrong while deleting Cheque!");
			e.printStackTrace();
		} finally {
			try {
				if (stmt != null) {
					stmt.close();
				}

				if (connection != null) {
					connection.close();
				}
				;

			} catch (Exception e) {
				e.printStackTrace();
			}
		}
	}

}
