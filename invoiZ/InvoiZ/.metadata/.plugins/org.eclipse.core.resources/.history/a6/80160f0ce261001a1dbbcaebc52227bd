package dataSource;

import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

import javax.swing.JOptionPane;
import javax.swing.JTable;

import net.proteanit.sql.DbUtils;

public class DataRepot {

	public static void InvoiceReportByMonth(JTable ui_table, String db_table, String InvoiceNO) {

		Connection connection = null;
		connection = DatabaseConnect.dbConnector();
		Statement stmt = null;
//TODO add dealer name to invoice and cheque tables
		String sql = "SELECT `InvoiceNo`, `ChequeNo`, `InvoiceAmount`,'DealerName', `InvoiceDate`, `InvoiceDeadline`,'Short',`CashAmount` FROM `invoice` WHERE `InvoiceNo` LIKE '" + InvoiceNO + "%'";
		try {
			stmt = connection.prepareStatement(sql);
			ResultSet rs = stmt.executeQuery(sql);
			ui_table.setModel(DbUtils.resultSetToTableModel(rs));
			// JOptionPane.showMessageDialog(null, "tables are loaded");
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			JOptionPane.showMessageDialog(null, "Oops, something went wrong while fetching data From Database!");
			e.printStackTrace();
		}finally {
			try {		
				 if (stmt != null) { stmt.close(); }
				 if (connection != null) {connection.close();};
				
				}catch (Exception e) {
					e.printStackTrace();
				}
			}

	}

}
